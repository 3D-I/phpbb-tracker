<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet type="text/xsl" href="contrib/xsl/modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.1.xsd">
	<header>
		<license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
		<title lang="en">phpBB Tracker</title>
		<description lang="en">Full tracker add-on for phpBB 3.0.x</description>
		<author-group>
			<author>
				<realname>J. Russo</realname>
				<email>jrsweets@gmail.com</email>
				<username>JRSweets</username>
				<homepage>http://www.jeffrusso.net</homepage>
				<contributions />
			</author>
			<author>
				<realname>Igor Wiedler</realname>
				<email>evil3@phpbb.com</email>
				<username>evil&lt;3</username>
				<homepage>http://phpbbmodders.net</homepage>
				<contributions />
			</author>
		</author-group>
		<author-notes><![CDATA[This MOD requires a minimum PHP version of 5.0.0.]]>
		</author-notes>
		<mod-version>0.1.3</mod-version>
		<installation>
			<level>easy</level>
			<time>500</time>
			<target-version>3.0.0</target-version>
		</installation>
		<history>
			<entry>
				<date>2008-03-04</date>
				<rev-version>0.1.0</rev-version>
				<changelog lang="en">
					<change>Initial Beta Release</change>
				</changelog>
			</entry>
			<entry>
				<date>2008-03-17</date>
				<rev-version>0.1.1</rev-version>
				<changelog lang="en">
					<change>Added management options to ticket reply</change>
					<change>Added attachement form to subsilver2 templates</change>
					<change>Added htmlspecialchars_decode() for emails</change>
					<change>Added check to block blank entries in ACP</change>
					<change>Added visual update to search box</change>
					<change>Fixed bug viewing all users tickets</change>
					<change>Fixed bug with sort order for statistics</change>
					<change>Fixed bug with pagination while sorting/filtering tickets</change>
					<change>Fixed bug removing attachments for posts when deleting</change>
					<change>Fixed bug with language variables when viewing statistics</change>
					<change>Fixed bug with installation script and updating from older versions</change>
					<change>Fixed bug causing tracker link to appearin viewonline breadcrumbs/nav links</change>
					<change>Increased size of ticket and post description</change>
				</changelog>
			</entry>
			<entry>
				<date>2008-03-18</date>
				<rev-version>0.1.2</rev-version>
				<changelog lang="en">
					<change>Added group support to "Show tickets assigned to me"</change>
					<change>Fixed bug causing missing column in project table</change>
					<change>Fixed bug with missing htmlspecialchars_decode in email subject</change>
					<change>Fixed various bugs with installer/updater</change>
				</changelog>
			</entry>
			<entry>
				<date>2008-xx-xx</date>
				<rev-version>0.1.3</rev-version>
				<changelog lang="en">
					<change>Updated minimum PHP version to 5.0.0.</change>
				</changelog>
			</entry>
		</history>
	</header>
	<action-group>
		<copy>
			<file from="root/tracker.php" to="tracker.php" />
			<file from="root/adm/style/acp_tracker.html" to="adm/style/acp_tracker.html" />
			<file from="root/tracker_install/*.*" to="tracker_install/" />
			<file from="root/tracker_install/schemas/*.*" to="tracker_install/schemas/" />
			<file from="root/includes/acp/acp_tracker.php" to="includes/acp/acp_tracker.php" />
			<file from="root/includes/acp/info/acp_tracker.php" to="includes/acp/info/acp_tracker.php" />
			<file from="root/includes/tracker/tracker_api.php" to="includes/tracker/tracker_api.php" />
			<file from="root/includes/tracker/tracker_cache.php" to="includes/tracker/tracker_cache.php" />
			<file from="root/includes/tracker/tracker_class.php" to="includes/tracker/tracker_class.php" />
			<file from="root/includes/tracker/tracker_constants.php" to="includes/tracker/tracker_constants.php" />
			<file from="root/includes/tracker/tracker_download.php" to="includes/tracker/tracker_download.php" />
			<file from="root/includes/tracker/tracker_viewonline.php" to="includes/tracker/tracker_viewonline.php" />
			<file from="root/includes/tracker/tracker_status.php" to="includes/tracker/tracker_status.php" />
			<file from="root/includes/tracker/tracker_types.php" to="includes/tracker/tracker_types.php" />
			<file from="root/language/en/email/tracker_notify.txt" to="language/en/email/tracker_notify.txt" />
			<file from="root/language/en/email/tracker_notify_comment.txt" to="language/en/email/tracker_notify_comment.txt" />
			<file from="root/language/en/email/tracker_notify_status_double.txt" to="language/en/email/tracker_notify_status_double.txt" />
			<file from="root/language/en/email/tracker_notify_status_single.txt" to="language/en/email/tracker_notify_status_single.txt" />
			<file from="root/language/en/mods/permissions_tracker.php" to="language/en/mods/permissions_tracker.php" />
			<file from="root/language/en/mods/tracker.php" to="language/en/mods/tracker.php" />
			<file from="root/language/en/mods/tracker_install.php" to="language/en/mods/tracker_install.php" />
			<file from="root/language/en/mods/info_acp_tracker.php" to="language/en/mods/info_acp_tracker.php" />
			<file from="root/files/tracker/index.htm" to="files/tracker/index.htm" />
		</copy>
		<open src="includes/functions.php">
			<edit>
				<find>function page_header($page_title = '', $display_online_list = true)
{
	global $db, $config, $template, $SID, $_SID, $user, $auth, $phpEx, $phpbb_root_path;</find>
				<action type="after-add">	global $tracker;</action>
			</edit>
			<edit>
				<find>// The following assigns all _common_ variables that may be used at any point in a template.</find>
				<action type="after-add"><![CDATA[	if (!isset($tracker))
	{
		$user->add_lang('mods/tracker');
		$template->assign_var('U_TRACKER', append_sid("{$phpbb_root_path}tracker.$phpEx"));
	}]]></action>
			</edit>
		</open>
		<open src="viewonline.php">
			<edit>
				<find><![CDATA[		case 'ucp':
			$location = $user->lang['VIEWING_UCP'];

			// Grab some common modules
			$url_params = array(
				'mode=register'		=> 'VIEWING_REGISTER',
				'i=pm&mode=compose'	=> 'POSTING_PRIVATE_MESSAGE',
				'i=pm&'				=> 'VIEWING_PRIVATE_MESSAGES',
				'i=profile&'		=> 'CHANGING_PROFILE',
				'i=prefs&'			=> 'CHANGING_PREFERENCES',
			);

			foreach ($url_params as $param => $lang)
			{
				if (strpos($row['session_page'], $param) !== false)
				{
					$location = $user->lang[$lang];
					break;
				}
			}

			$location_url = append_sid("{$phpbb_root_path}index.$phpEx");
		break;]]></find>
				<action type="after-add"><![CDATA[		case 'tracker':
			include($phpbb_root_path . 'includes/tracker/tracker_viewonline.' . $phpEx);
		break;]]></action>
			</edit>
		</open>
		<diy-instructions lang="en">Run the included installer at http://yoursite.com/phpBB/tracker_install/install.php
Once done make sure to remove tracker_install folder from your server.</diy-instructions>
	</action-group>
</mod>